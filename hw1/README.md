# 人工智能中的编程 第一次作业

## 第一部分：

### `cifar.py`: 主程序

## 第二部分：实现 ```Tensor``` 类

本项目由 CMake 构建，使用 CUDA 12.6 和 C++20 标准.

### ```main.cu```: 主程序

包含了对 ReLU 和 Sigmoid 正反向传播的测试.

### ```tensor.cu```: ```Tensor``` 类的实现： 
- 对设备内存块的抽象 `DeviceSpace`，以及其引用计数模型 `device_ptr`，用于内部原始数据的存储.
- `TensorKernel` 命名空间：定义了一系列的 CUDA 核函数，用于实现 `Tensor` 的各种计算.
- `Tensor::cpu()`, `Tensor::gpu()`：用于在 CPU 和 GPU 之间进行 `Tensor` 的拷贝.
- `Tensor::relu()`, `Tensor::sigmoid()`: 计算 `Tensor` 的逐点 ReLU 和 Sigmoid 函数并返回结果 `Tensor`.
- `Tensor::relu_backward(...)`, `Tensor::sigmoid_backward(...)`: 计算 `Tensor` 的逐点 ReLU 和 Sigmoid 函数的反向传播并返回结果.

### 本机测试输出

```
Input Tensor t1:
[[[-1.00000000, -0.91666667, -0.83333333, -0.75000000],
[-0.66666667, -0.58333333, -0.50000000, -0.41666667],
[-0.33333333, -0.25000000, -0.16666667, -0.08333333]],
[[0.00000000, 0.08333333, 0.16666667, 0.25000000],
[0.33333333, 0.41666667, 0.50000000, 0.58333333],
[0.66666667, 0.75000000, 0.83333333, 0.91666667]]]

ReLU of t1:
[[[0.00000000, 0.00000000, 0.00000000, 0.00000000],
[0.00000000, 0.00000000, 0.00000000, 0.00000000],
[0.00000000, 0.00000000, 0.00000000, 0.00000000]],
[[0.00000000, 0.08333333, 0.16666667, 0.25000000],
[0.33333333, 0.41666667, 0.50000000, 0.58333333],
[0.66666667, 0.75000000, 0.83333333, 0.91666667]]]

Sigmoid of t1:
[[[0.26894143, 0.28563756, 0.30294070, 0.32082129],
[0.33924364, 0.35816595, 0.37754068, 0.39731467],
[0.41742981, 0.43782352, 0.45842953, 0.47917871]],
[[0.50000000, 0.52082128, 0.54157048, 0.56217650],
[0.58257020, 0.60268533, 0.62245933, 0.64183405],
[0.66075637, 0.67917869, 0.69705927, 0.71436243]]]

Upstream gradient:
[[[-0.93306010, -0.34007158, 0.38127141, -0.15502664],
[-0.58746972, -0.49974310, 0.27311705, 0.72724476],
[-0.39668874, -0.95015213, -0.27001458, 0.53076196]],
[[-0.36427947, -0.72854321, -0.78650948, 0.52134314],
[-0.83665543, 0.10191242, 0.12930378, 0.48654101],
[0.96352030, -0.56230041, -0.09120816, 0.03730805]]]

ReLU backward of t1:
[[[0.00000000, 0.00000000, 0.00000000, 0.00000000],
[0.00000000, 0.00000000, 0.00000000, 0.00000000],
[0.00000000, 0.00000000, 0.00000000, 0.00000000]],
[[0.00000000, -0.72854321, -0.78650948, 0.52134314],
[-0.83665543, 0.10191242, 0.12930378, 0.48654101],
[0.96352030, -0.56230041, -0.09120816, 0.03730805]]]

Sigmoid backward of t1:
[[[-0.18345075, -0.06939118, 0.08051218, -0.03377953],
[-0.13168568, -0.11488249, 0.06418352, 0.17414292],
[-0.09646763, -0.23386483, -0.06703703, 0.13246039]],
[[-0.09106987, -0.18181996, -0.19526820, 0.12832032],
[-0.20345968, 0.02440351, 0.03038687, 0.11184756],
[0.21598020, -0.12252245, -0.01926021, 0.00761266]]]
```